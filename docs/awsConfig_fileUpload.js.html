<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: awsConfig/fileUpload.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: awsConfig/fileUpload.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

const AWS = require('aws-sdk');
const multer = require('multer');
const multerS3 = require('multer-s3');
const path = require('path');

const config = require('./config');

AWS.config.update({
  region: config.REGION,
  accessKeyId: config.ACCESS_KEY_ID,
  secretAccessKey: config.SECRET_ACCESS_KEY,
});

let s3 = new AWS.S3();

const s3Upload = multer({
  storage: multerS3({
    acl: 'public-read',
    s3,
    bucket: config.BUCKET_NAME,
    key: function (req, file, cb) {
      let extension = path.extname(file.originalname);
      let fileName = path.basename(file.originalname, extension);
      cb(null, fileName + new Date().getTime() + extension);
    }
  })
});

/**
@module s3Upload
*/
module.exports.s3Upload = s3Upload;
/**
* @function deleteS3File
* @param {String} key
* @returns {Promise}
*/
module.exports.deleteS3File = function(key) {
  new Promise(function(resolve, reject) {
    let deleteParams = {
      Bucket: config.BUCKET_NAME,
      Key: key,
    };
    s3.deleteObject(deleteParams, function(err, data) {
      if(!err) {
        resolve(data);
      } else {
        reject(error);
      }
    });
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-s3Upload.html">s3Upload</a></li></ul><h3>Classes</h3><ul><li><a href="FileController.html">FileController</a></li><li><a href="FileSchema.html">FileSchema</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Fri Aug 30 2019 16:09:08 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
